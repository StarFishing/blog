(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{320:function(e,t,a){"use strict";a.r(t);var i=a(39),r=Object(i.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"requestanimationframe-api-实现动画效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requestanimationframe-api-实现动画效果","aria-hidden":"true"}},[e._v("#")]),e._v(" requestAnimationFrame() API 实现动画效果")]),e._v(" "),a("h2",{attrs:{id:"为什么要使用-requestanimationframe："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么要使用-requestanimationframe：","aria-hidden":"true"}},[e._v("#")]),e._v(" 为什么要使用 requestAnimationFrame：")]),e._v(" "),a("ol",[a("li",[a("ul",[a("li",[e._v("我们知道，浏览器实现动画绘制无非就是 CSS3 的动画属性"),a("code",[e._v("transition")]),e._v("，"),a("code",[e._v("aniamtion")]),e._v("和 JavaScript 的"),a("code",[e._v("setTImeOut")]),e._v("和"),a("code",[e._v("setInterval")]),e._v("方法（进行 DOM 的样式循环改变达到动画效果）。说到这可能很多同学都有疑问了，既然有 CSS 的动画属性这么方便的东西了，为何还要用"),a("code",[e._v("setTimeOut")]),e._v("等 js 方法这么麻烦呢？我们首先来解决这个疑问。")])])]),e._v(" "),a("li",[a("ol",[a("li",[a("h3",{attrs:{id:"css3-的动画属性与-javascript-的动画方法："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css3-的动画属性与-javascript-的动画方法：","aria-hidden":"true"}},[e._v("#")]),e._v(" CSS3 的动画属性与 JavaScript 的动画方法：")])]),e._v(" "),a("li",[a("ol",[a("li",[a("ol",[a("li",[e._v("一个事物的存在必有其存在的道理，api 也不例外，不然早被淘汰了。首先 CSS3 的动画属性是存在兼容问题的，最明显的就是 IE10 之后才兼容。而目前主流的向下兼容的标准还是要达到 IE9 的，所以"),a("code",[e._v("setTImeOut")]),e._v("等 js 方法还是主流的动画解决方案。")])])]),e._v(" "),a("li",[e._v("有些动画效果 CSS3 无法实现，如改变元素"),a("code",[e._v("scrollTop")]),e._v("的值进行滚动，这样就只能使用 js 的相关方法了。")]),e._v(" "),a("li",[e._v("CSS3 的动画无法实现过于复杂的动画效果，如 CSS3 支持控制动画速度"),a("a",{attrs:{href:"https://www.zhangxinxu.com/wordpress/2013/08/%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF-cubic-bezier-css3%E5%8A%A8%E7%94%BB-svg-canvas/",target:"_blank",rel:"noopener noreferrer"}},[e._v("赛贝尔曲线"),a("OutboundLink")],1),e._v("的数值有限，更复杂的动画效果得使用 js 结合相关算法才能完成")])])])])]),e._v(" "),a("li",[a("ul",[a("li",[e._v("接着回到正题哈， 那"),a("code",[e._v("requestAnimationFrame")]),e._v("有"),a("code",[e._v("setTimeOut")]),e._v("和"),a("code",[e._v("setInterval")]),e._v("又有和区别呢，嗯，接下来就是正题了。")]),e._v(" "),a("li",[a("h3",{attrs:{id:"settimeout和setinterval出现的问题："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#settimeout和setinterval出现的问题：","aria-hidden":"true"}},[e._v("#")]),e._v(" "),a("code",[e._v("setTimeOut")]),e._v("和"),a("code",[e._v("setInterval")]),e._v("出现的问题：")])])])]),e._v(" "),a("li",[a("ol",[a("li",[a("ol",[a("li",[a("ol",[a("li",[e._v("首先，我们得知道动画的渲染是一帧一帧的进行的，每一帧就是动画的一个静止状态，每一帧连起来就成为了一个动画。因此每一帧的时间间隔要足够短动画才显得平滑流畅，但每一帧又不能间隔得太短，因为浏览器每一秒的渲染能是有限的，而且屏幕的刷新能力也是有限的，大多数的显示器刷新频率是 60H 也就是每秒 60 帧，因此浏览器的重绘频率不会超过显示器的刷新频率。")])])]),e._v(" "),a("li",[a("p",[e._v("所以每一帧大约 17 秒就是最佳的重绘间隔。那使用就直接使用"),a("code",[e._v("setTimeOut")]),e._v("或者"),a("code",[e._v("setInterval")]),e._v("，间隔设置为 17 不就得了？但这样还是不行的。")])]),e._v(" "),a("li",[a("ol",[a("li",[e._v("因浏览器的毫秒不精确：浏览器的计时器精度并非精确到毫秒级的，IE8 的精确度是 15ms 多一点，而 IE9 等大多数的浏览器精确度都在 4ms 差不多。所以难以保证动画最佳的时间间隔。")]),e._v(" "),a("li",[e._v("不同的浏览器渲染能力不同，因此并非每一帧 17ms 就是最佳渲染间隔。")]),e._v(" "),a("li",[e._v("在不需要动画的地方，如后台标签页，动画任然在运行，消耗 CPU 的性能。")])])])])])])]),e._v(" "),a("li",[a("ul",[a("li",[e._v("因此，h5 的"),a("code",[e._v("requestAnimationFrame")]),e._v("就是解决以上问题的。")])])]),e._v(" "),a("li",[a("ol",[a("li",[a("h3",{attrs:{id:"requestanimationframe-的特点："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requestanimationframe-的特点：","aria-hidden":"true"}},[e._v("#")]),e._v(" requestAnimationFrame 的特点：")])]),e._v(" "),a("li",[a("ul",[a("li",[a("ol",[a("li",[a("code",[e._v("requestAnimationFrame")]),e._v("会把每一帧中所有的 DOM 操作集中起来，在一次重绘或者重排中就完成。")])])])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[e._v("requestAnimationFrame")]),e._v("重绘或者重排的时间间隔是系统的时间间隔，因为不同的浏览器的系统时间间隔不同，"),a("code",[e._v("requestAnimationFrame")]),e._v("将会保持最佳的绘制间隔，即不会因为绘制间隔时间过短而造成浏览器渲染能力跟不上，也不会因为绘制间隔时间过长，而造成动画卡顿。这样就能在不同的浏览器中实现最佳的绘制效果。")]),e._v(" "),a("li",[e._v("在隐藏或者不可见的元素中，"),a("code",[e._v("requestAnimationFrame")]),e._v("将不会进行重排或者重绘，而运行在页面没有激活的情况下，如"),a("code",[e._v("requestAnimationFrame")]),e._v("运行在后台标签页中，动画将会暂停，有效的节省了 CPU 的开销。")])])])])])]),e._v(" "),a("ul",[a("li",[a("ul",[a("li",[e._v("那么，该如何使用"),a("code",[e._v("requestAnimationFrame")]),e._v("呢？")])])])]),e._v(" "),a("h2",{attrs:{id:"requestanimationframe-的具体使用："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requestanimationframe-的具体使用：","aria-hidden":"true"}},[e._v("#")]),e._v(" requestAnimationFrame 的具体使用：")]),e._v(" "),a("ul",[a("li",[a("ul",[a("li",[a("code",[e._v("requestAnimationFrame")]),e._v("使用非常简单，只需传入改变 DOM 的函数，然后反复调用"),a("code",[e._v("requestAnimationFrame")]),e._v("即可达到动画效果了。requestAnimationFrame 返回一个整数型请求 id 的，可以用"),a("code",[e._v("cancelAnimationFrame")]),e._v("函数去取消传入"),a("code",[e._v("requestAnimationFrame")]),e._v("的回调函数。具体使用可以看"),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame",target:"_blank",rel:"noopener noreferrer"}},[e._v("MDN 的教程"),a("OutboundLink")],1),e._v("。")])])])])])},[],!1,null,null,null);t.default=r.exports}}]);